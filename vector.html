<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>全能矢量格式转换器 - 由 Vector Express API 驱动</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath fill='%235a64ff' d='M50 5 L95 27.5 L95 72.5 L50 95 L5 72.5 L5 27.5 Z M50 20 L80 37.5 L50 55 L20 37.5 Z M20 45 L20 62.5 L50 80 L80 62.5 L80 45 L50 62.5 Z'/%3E%3C/svg%3E" type="image/svg+xml">
    
    <style>
        :root {
            --main-color: #5a64ff;
            --btcolor: linear-gradient(113deg, #4c73ff, #6a52ff);
            --text1: #1a1d2e;
            --text2: #4a4e6d;
            --text3: #8d8fa3;
            --bg-light: #f9fafb;
            --border: #e2e4f0;
            --success: #33b763;
            --warning: #f59e0b;
            --error: #ef4444;
            --card-shadow: 0 4px 20px rgba(90, 100, 255, 0.12);
        }

        body {
            background-color: #f5f7ff;
            background-image: url(img/download.webp);
    		background-size: cover;
            color: var(--text1);
            min-height: 100vh;
            display: flex;
            margin: 0;
        }
        .icon {
            display: inline-block;
            width: 1.2em;
            height: 1.2em;
            fill: currentColor;
        }
        .type {
            background: #ebeeff;
            border-radius: 14px;
            padding: 2px 10px;
            color: var(--main-color);
            font-size: 12px;
        }
        .arrow-r {
            display: flex; 
            align-items: center; 
            color: #c4c7e7; 
            font-size: 32px; 
            justify-content: center;
        }
        .type-panel {
            display: flex;
            flex-direction: column;
        }
        .type-title {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--text2);
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 20px;
            flex-wrap: wrap;
            border-top: 1px solid var(--border);
            padding-top: 20px;
        }
        .type-s {
            display: block;
            color: var(--text3);
            font-size: 0.8rem;
        }
        .type-group {
            display: flex; 
            gap: 10px;
        }
        .type-cont {
            background: var(--bg-light);
            border-radius: 6px;
            padding: 14px;
            display: flex;
            flex-direction: column;
            flex-wrap: wrap;
            width: 50%;
        }
        .type-geshi {    
            gap: 10px;
            display: flex;
            flex-wrap: wrap;
            margin: 10px 0;
        }
        .container {
            width: 1200px;
            margin: 0 auto;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            margin-bottom: 80px;
        }
        header { text-align: center; padding: 30px; }
        h1 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            background: var(--btcolor);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 800;
            letter-spacing: -0.5px;
        }
        .subtitle { color: var(--text2); font-size: 0.9rem; margin: 0 auto; max-width: 600px; }
        .tool-container { display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 10px; }
        .settings-panel {
            flex: 1;
            min-width: 300px;
            align-self: flex-start;
            padding-right: 20px;
            align-self: flex-start;
            background: #fff;
            border-radius: 10px;
            padding: 20px;
            height: -webkit-fill-available;
            box-shadow: 0 0 10px #b9cbda42;
            min-height: 480px;
        }
        .preview-panel {
            flex: 2;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            background: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 10px #b9cbda42;
        }
        .panel-title {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: var(--text1);
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 0;
            flex-wrap: wrap;
        }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 6px; font-weight: 600; color: var(--text2); font-size: 1.0rem; }
        select {
            width: 100%;
            padding: 10px 20px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 1.05rem;
            color: var(--text1);
            transition: all 0.3s;
            background: var(--bg-light);
            -webkit-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%238d8fa3'%3E%3Cpath d='M6 9L0 3h12z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            padding-right: 40px;
        }
        select:focus { outline: none; border-color: var(--main-color); box-shadow: 0 0 0 3px rgba(90, 100, 255, 0.2); }
        .drop-area {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background-color: rgba(90, 100, 255, 0.03);
            position: relative;
            overflow: hidden;
        }
        .drop-area:hover, .drop-area.drag-over { border-color: var(--main-color); background-color: rgba(90, 100, 255, 0.08); }
        .drop-icon { font-size: 3rem; color: #5a64ff80; opacity: 0.7; }
        .drop-text { color: var(--text2); margin-bottom: 10px; font-size: 1.0rem; font-weight: 500; }
        .drop-text u { color: var(--main-color); text-decoration: none; font-weight: 600; }
        .drop-hint { color: var(--text3); font-size: 0.9rem; max-width: 300px; margin: 0 auto; }
        #fileInput { position: absolute; width: 100%; height: 100%; top: 0; left: 0; opacity: 0; cursor: pointer; }
        .preview-container { flex: 1; }
        .image-row {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 10px;
            background: var(--bg-light);
            position: relative;
            overflow: hidden;
        }
        .thumbnail {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            margin-right: 20px;
            flex-shrink: 0;
            border: 1px solid var(--border);
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .thumbnail img, .thumbnail .file-icon { max-width: 80%; max-height: 80%; object-fit: contain; }
        .thumbnail .file-icon { font-size: 2.5rem; color: var(--border); }
        .image-info { flex: 1; padding-right: 15px; overflow: hidden; }
        .image-name { font-weight: 600; color: var(--text1); font-size: 1rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: 5px; }
        .format-info { font-size: 0.9rem; color: var(--text2); }
        .format-arrow { color: var(--main-color); font-weight: bold; margin: 0 8px; }
        .status-badge { padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; color: white; min-width: 70px; text-align: center; flex-shrink: 0; }
        .status-badge.pending { background: var(--warning); }
        .status-badge.success { background: var(--success); }
        .status-badge.error { background: var(--error); }
        .download-btn-small { padding: 8px 16px; color: var(--main-color); background: none; border: none; border-radius: 20px; font-size: 0.9rem; cursor: pointer; transition: all 0.3s; margin-left: 15px; white-space: nowrap; flex-shrink: 0; }
        .download-btn-small:hover { text-decoration: underline; }
        .download-btn-small:disabled { color: var(--text3); cursor: not-allowed; }
        .no-preview { text-align: center; padding: 80px 20px; color: var(--text3); flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .no-preview svg { font-size: 4rem; margin-bottom: 25px; color: var(--border); opacity: 0.5; font-style: normal; }
        .no-preview p { font-size: 0.9rem; max-width: 400px; margin: 0 auto; line-height: 1.7; }
        .status { text-align: center; color: var(--text2); font-size: 0.9rem; font-weight: 400; }
        .download-all-container { text-align: center; padding: 10px; position: fixed; bottom: 0; background: #ffffff52; margin: 0 auto; left: 0; right: 0; backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); box-shadow: 0 -5px 20px rgba(0,0,0,0.05); }
        .download-all-btn { display: inline-flex; align-items: center; justify-content: center; padding: 10px 25px; background: var(--btcolor); color: white; border: none; border-radius: 30px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 8px 25px rgba(90, 100, 255, 0.3); }
        .download-all-btn:disabled { background: #ccc; cursor: not-allowed; transform: none; box-shadow: none; }
        .download-all-btn:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 12px 30px rgba(90, 100, 255, 0.4); }
        .counter { display: inline-block; background: white; color: var(--main-color); font-weight: 700; padding: 3px 12px; border-radius: 100px; margin-left: 12px; font-size: 0.9rem; }
        .progress-container { height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; margin-top: 8px; }
        .progress-bar { height: 100%; background: var(--success); width: 0%; transition: width 0.5s ease; }
        .clear-all-btn { background: none; border: 1px solid var(--border); color: var(--text3); padding: 8px 15px; border-radius: 30px; cursor: pointer; font-size: 0.9rem; transition: all 0.3s; }
        .clear-all-btn:hover { color: var(--main-color); border-color: var(--main-color); background: rgba(90, 100, 255, 0.05); }
        @media (max-width: 768px) {
            .arrow-r { transform: rotate(90deg); }
            .type-group { flex-direction: column; }
            .type-cont { width: 100%; }
            .settings-panel { width: 100%; border-right: none; }
            .container { width: 100%; padding: 0 10px; }
            .tool-container { flex-direction: column; }
            .image-row { flex-wrap: wrap; padding: 15px; }
            .thumbnail { margin-bottom: 10px; }
            .image-info { width: calc(100% - 80px); margin-bottom: 10px; }
            .status-badge, .download-btn-small { margin: 10px 0 0 0; box-sizing: border-box; justify-content: center; display: inline-flex; align-items: center; }
        }
    </style>
</head>
<body>
<svg width="0" height="0" class="hidden">
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" id="circle-right-solid-full"><path d="M64 320C64 461.4 178.6 576 320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320zM451.3 331.3L347.3 435.3C342.7 439.9 335.8 441.2 329.9 438.8C324 436.4 320 430.5 320 424L320 368L224 368C206.3 368 192 353.7 192 336L192 304C192 286.3 206.3 272 224 272L320 272L320 216C320 209.5 323.9 203.7 329.9 201.2C335.9 198.7 342.8 200.1 347.3 204.7L451.3 308.7C457.5 314.9 457.5 325.1 451.3 331.3z"></path></symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" id="cloud-arrow-up-solid-full"><path d="M176 544C96.5 544 32 479.5 32 400C32 336.6 73 282.8 129.9 263.5C128.6 255.8 128 248 128 240C128 160.5 192.5 96 272 96C327.4 96 375.5 127.3 399.6 173.1C413.8 164.8 430.4 160 448 160C501 160 544 203 544 256C544 271.7 540.2 286.6 533.5 299.7C577.5 320 608 364.4 608 416C608 486.7 550.7 544 480 544L176 544zM337 255C327.6 245.6 312.4 245.6 303.1 255L231.1 327C221.7 336.4 221.7 351.6 231.1 360.9C240.5 370.2 255.7 370.3 265 360.9L296 329.9L296 432C296 445.3 306.7 456 320 456C333.3 456 344 445.3 344 432L344 329.9L375 360.9C384.4 370.3 399.6 370.3 408.9 360.9C418.2 351.5 418.3 336.3 408.9 327L336.9 255z"></path></symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" id="file-lines-solid-full"><path d="M128 0C92.7 0 64 28.7 64 64L64 576C64 611.3 92.7 640 128 640L512 640C547.3 640 576 611.3 576 576L576 224L384 224C357.5 224 336 202.5 336 176L336 0L128 0zM160 240C160 231.2 167.2 224 176 224L464 224C472.8 224 480 231.2 480 240C480 248.8 472.8 256 464 256L176 256C167.2 256 160 248.8 160 240zM160 320C160 311.2 167.2 304 176 304L464 304C472.8 304 480 311.2 480 320C480 328.8 472.8 336 464 336L176 336C167.2 336 160 328.8 160 320zM160 400C160 391.2 167.2 384 176 384L464 384C472.8 384 480 391.2 480 400C480 408.8 472.8 416 464 416L176 416C167.2 416 160 408.8 160 400zM416 0L576 160L416 160L416 0z"></path></symbol>
</svg>
<div class="container">
    <header>
        <h1>全能矢量格式转换器</h1>
        <p class="subtitle">在线转换 AI, CDR, DWG, DXF, EPS, PDF, PLT, SVG 等矢量文件格式。由 vector.express 提供支持。</p>
    </header>

    <div class="tool-container">
        <div class="settings-panel">
            <h2 class="panel-title">转换设置</h2>

            <div class="form-group">
                <div class="drop-area" id="dropArea">
                    <div class="drop-icon">
                        <svg class="icon"><use xlink:href="#cloud-arrow-up-solid-full"></use></svg>
                    </div>
                    <p class="drop-text">拖放文件到此处 或 <u>点击选择</u></p>
                    <p class="drop-hint">支持常见的矢量格式</p>
                    <input type="file" id="fileInput" accept=".ai,.cdr,.dwg,.dxf,.eps,.hpgl,.pdf,.plt,.ps,.svg" multiple>
                </div>
            </div>

            <div class="form-group">
                <label for="outputFormat">选择输出格式</label>
                <select id="outputFormat">
                    <option value="" selected disabled>请选择</option>
                    <option value="svg">SVG</option>
                    <option value="pdf">PDF</option>
                    <option value="eps">EPS</option>
                </select>
                <div id="formatError" style="color: red; display: none; margin-top: 5px; font-size: 0.9rem;">
                    请先选择输出格式
                </div>
            </div>
             <div class="drop-hint" style="margin: 0; max-width: fit-content;">注：API 转换过程在云端进行，请勿上传敏感文件。</div>
        </div>

        <div class="preview-panel">
            <h2 class="panel-title">
                <span>转换队列 (<span id="fileCount">0</span>)</span>
                <div class="status" id="status">
                    <div>准备上传文件...</div>
                    <div class="progress-container">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                </div>
                <button id="clearAllBtn" class="clear-all-btn" style="display:none;">清空队列</button>
            </h2>
            <div class="preview-container" id="previewContainer">
                <div class="no-preview" id="noPreviewMessage">
                    <svg class="icon" style="font-size: 5rem; color: #d7d9e5;"><use xlink:href="#file-lines-solid-full"></use></svg>
                    <p>上传文件后将在此处开始转换</p>
                </div>
            </div>

            <div class="download-all-container" id="downloadAllContainer" style="display:none;">
                <button class="download-all-btn" id="downloadAllBtn" disabled>
                    下载全部
                    <span class="counter" id="convertedFileCounter">0</span>
                </button>
            </div>

            <div class="type-panel">
                <div class="type-title">支持多种矢量格式转换</div>
                <div class="type-group">
                    <div class="type-cont">
                        <div class="type-s">支持的导入格式</div>
                        <div class="type-geshi">	
                            <span class="type">AI</span><span class="type">CDR</span><span class="type">DWG</span><span class="type">DXF</span>
                            <span class="type">EPS</span><span class="type">HPGL</span><span class="type">PDF</span><span class="type">PLT</span>
                            <span class="type">PS</span><span class="type">SVG</span>
                        </div>
                    </div>
                    <div class="arrow-r">
                        <svg class="icon"><use xlink:href="#circle-right-solid-full"></use></svg>
                    </div>
                    <div class="type-cont">
                        <div class="type-s">支持的输出格式</div>
                        <div class="type-geshi">
                            <span class="type">SVG</span><span class="type">PDF</span><span class="type">EPS</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const fileInput = document.getElementById('fileInput');
    const dropArea = document.getElementById('dropArea');
    const previewContainer = document.getElementById('previewContainer');
    const outputFormatSelect = document.getElementById('outputFormat');
    const noPreviewMessage = document.getElementById('noPreviewMessage');
    const statusElement = document.getElementById('status');
    const progressBar = document.getElementById('progressBar');
    const fileCount = document.getElementById('fileCount');
    const convertedFileCounter = document.getElementById('convertedFileCounter');
    const clearAllBtn = document.getElementById('clearAllBtn');
    const downloadAllContainer = document.getElementById('downloadAllContainer');
    const downloadAllBtn = document.getElementById('downloadAllBtn');
    const formatError = document.getElementById('formatError');

    let fileQueue = [];
    let convertedFiles = {};
    let uniqueId = 0;

    outputFormatSelect.addEventListener('change', () => {
        if (outputFormatSelect.value) {
            formatError.style.display = 'none';
        }
    });

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, preventDefaults, false);
        document.body.addEventListener(eventName, preventDefaults, false);
    });
    ['dragenter', 'dragover'].forEach(eventName => dropArea.addEventListener(eventName, () => dropArea.classList.add('drag-over'), false));
    ['dragleave', 'drop'].forEach(eventName => dropArea.addEventListener(eventName, () => dropArea.classList.remove('drag-over'), false));
    
    dropArea.addEventListener('drop', handleDrop, false);
    fileInput.addEventListener('change', (e) => { handleFiles(e.target.files); e.target.value = ''; });
    clearAllBtn.addEventListener('click', clearQueue);
    downloadAllBtn.addEventListener('click', downloadAll);
    
    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }
    
    function handleDrop(e) {
        if (!outputFormatSelect.value) {
            formatError.style.display = 'block';
            return;
        }
        formatError.style.display = 'none';
        handleFiles(e.dataTransfer.files);
    }

    async function handleFiles(files) {
        if (!outputFormatSelect.value) {
            formatError.style.display = 'block';
            return;
        }
        formatError.style.display = 'none';
        
        if (files.length === 0) return;
        noPreviewMessage.style.display = 'none';
        
        const newFiles = Array.from(files).map(file => ({
            id: uniqueId++,
            file: file,
            status: 'pending'
        }));
        
        fileQueue.push(...newFiles);
        newFiles.forEach(createPreviewRow);
        
        updateUI();
        processQueue();
    }

    function createPreviewRow(fileData) {
        const { id, file } = fileData;
        const row = document.createElement('div');
        row.className = 'image-row';
        row.id = `row-${id}`;
        
        const fileExt = file.name.split('.').pop().toLowerCase();
        const originalFormat = fileExt.toUpperCase();

        let thumbnailHTML = `<div class="file-icon"><svg class="icon"><use xlink:href="#file-lines-solid-full"></use></svg></div>`;
        if (fileExt === 'svg') {
            const previewUrl = URL.createObjectURL(file);
            thumbnailHTML = `<img id="thumb-${id}" src="${previewUrl}" alt="SVG预览">`;
        }

        row.innerHTML = `
            <div class="thumbnail">
                ${thumbnailHTML}
            </div>
            <div class="image-info">
                <div class="image-name" title="${file.name}">${file.name}</div>
                <div class="format-info">
                    <span class="original-format">${originalFormat}</span>
                    <span class="format-arrow">→</span>
                    <span class="target-format">...</span>
                </div>
            </div>
            <div id="status-${id}" class="status-badge pending">待转换</div>
            <button id="download-${id}" class="download-btn-small" disabled>下载</button>
        `;
        previewContainer.appendChild(row);
    }

    async function processQueue() {
        for (const fileData of fileQueue) {
            if (fileData.status === 'pending') {
                try {
                    await convertFileWithAPI(fileData);
                    fileData.status = 'success';
                } catch (error) {
                    console.error('转换失败:', fileData.file.name, error);
                    fileData.status = 'error';
                }
                updateRowUI(fileData);
                updateUI();
            }
        }
        updateStatus("所有任务处理完成！");
    }

    async function convertFileWithAPI(fileData) {
        const { id, file } = fileData;
        const inputFormat = file.name.split('.').pop().toLowerCase();
        const outputFormat = outputFormatSelect.value;
        
        updateStatus(`正在转换 ${file.name}...`);
        
        // 将 apiUrl 修改为以下地址
        const apiUrl = `https://vector-proxy.designtool.site/api/convert/${inputFormat}/auto/${outputFormat}`;

        const response = await fetch(apiUrl, {
            method: 'POST',
            body: file,
            headers: {
                'Content-Type': file.type || 'application/octet-stream',
            },
        });

        if (!response.ok) {
            const errorText = await response.text();
            throw new Error(`API 请求失败 (状态 ${response.status}): ${errorText}`);
        }

        const resultBlob = await response.blob();
        if (!resultBlob) throw new Error('未能从 API 获取转换后的文件 Blob');

        const newFileName = `${file.name.split('.').slice(0, -1).join('.')}.${outputFormat}`;
        convertedFiles[id] = new File([resultBlob], newFileName, { type: resultBlob.type });
    }


    function updateRowUI(fileData) {
        const { id, status } = fileData;
        const row = document.getElementById(`row-${id}`);
        if (!row) return;

        const statusBadge = document.getElementById(`status-${id}`);
        const downloadBtn = document.getElementById(`download-${id}`);
        const targetFormatElem = row.querySelector('.target-format');
        
        targetFormatElem.textContent = outputFormatSelect.value.toUpperCase();
        
        if (status === 'success') {
            statusBadge.textContent = '转换成功';
            statusBadge.className = 'status-badge success';
            downloadBtn.disabled = false;
            downloadBtn.onclick = () => saveAs(convertedFiles[id]);
        } else if (status === 'error') {
            statusBadge.textContent = '转换失败';
            statusBadge.className = 'status-badge error';
            downloadBtn.disabled = true;
        }
    }
    
    function updateUI() {
        const totalFiles = fileQueue.length;
        const completedCount = fileQueue.filter(f => f.status !== 'pending').length;
        const convertedCount = Object.keys(convertedFiles).length;

        fileCount.textContent = totalFiles;
        convertedFileCounter.textContent = convertedCount;
        
        const progress = totalFiles > 0 ? (completedCount / totalFiles) * 100 : 0;
        progressBar.style.width = `${progress}%`;
        
        if (totalFiles > 0 && completedCount < totalFiles) {
             updateStatus(`处理中... ${completedCount} / ${totalFiles}`);
        } else if (totalFiles > 0 && completedCount === totalFiles) {
            updateStatus("所有任务处理完成！");
        }
         else {
            updateStatus("准备上传文件...");
        }

        const hasFiles = totalFiles > 0;
        clearAllBtn.style.display = hasFiles ? 'inline-block' : 'none';
        downloadAllContainer.style.display = hasFiles ? 'block' : 'none';
        downloadAllBtn.disabled = convertedCount === 0;
    }
    
    function updateStatus(message) {
        statusElement.querySelector('div:first-child').textContent = message;
    }

    function clearQueue() {
        // 释放可能创建的 SVG 预览 URL
        fileQueue.forEach(fileData => {
            const thumb = document.getElementById(`thumb-${fileData.id}`);
            if (thumb && thumb.src.startsWith('blob:')) {
                URL.revokeObjectURL(thumb.src);
            }
        });

        fileQueue = [];
        convertedFiles = {};
        previewContainer.innerHTML = ''; 
        noPreviewMessage.style.display = 'block';
        updateUI();
    }
    
    function downloadAll() {
        if (Object.keys(convertedFiles).length === 0) return;

        const zip = new JSZip();
        for (const id in convertedFiles) {
            const file = convertedFiles[id];
            zip.file(file.name, file);
        }

        updateStatus('正在打包文件...');
        zip.generateAsync({ type: 'blob' })
            .then(content => {
                saveAs(content, 'converted_vectors.zip');
                updateStatus('打包完成！');
            })
            .catch(err => {
                console.error('打包失败:', err);
                updateStatus('打包失败，请检查控制台。');
            });
    }
</script>
</body>
</html>